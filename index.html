<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SpellRightPro</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore-compat.js"></script>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-0YSR05E7NR"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-0YSR05E7NR');
  </script>

  <!-- Styles -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f8f9fa;
    }
    .container {
      max-width: 960px;
      margin: auto;
      padding: 20px;
    }
    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      margin-top: 15px;
    }
    .form-row label {
      min-width: 100px;
    }
    .form-row input, .form-row select, .form-row textarea {
      flex: 1;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .btn {
      padding: 10px 15px;
      margin: 5px;
      border: none;
      background: #007bff;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }
    .btn:hover { background: #0056b3; }
    .btn-info { background: #17a2b8; }
    .btn-success { background: #28a745; }
    .btn-warning { background: #ffc107; color: black; }
    .notification {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #333;
      color: #fff;
      padding: 12px 18px;
      border-radius: 5px;
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
      z-index: 1000;
    }
    .notification.show { opacity: 1; }
    @media (max-width: 600px) {
      .form-row {
        flex-direction: column;
        align-items: stretch;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>SpellRightPro</h1>

    <div class="form-row">
      <label>Email:</label>
      <input type="email" id="userEmail" placeholder="Enter email" />
      <label>Password:</label>
      <input type="password" id="userPassword" placeholder="Enter password" />
      <button onclick="loginUser()" class="btn">Login</button>
      <button onclick="signUpUser()" class="btn btn-info">Sign Up</button>
      <button onclick="logoutUser()" class="btn btn-warning">Logout</button>
      <span id="loginStatus"></span>
    </div>

    <div class="form-row">
      <button onclick="startPractice()" class="btn btn-info">Start Practice</button>
      <button onclick="startTest()" class="btn btn-success">Start Test</button>
      <button onclick="addCustomWords()" class="btn">Add Custom Words</button>
      <button onclick="saveWordList()" class="btn btn-info">Save Words</button>
      <button onclick="loadWordList()" class="btn btn-success">Load Words</button>
      <button onclick="clearWordList()" class="btn btn-warning">Clear Words</button>
    </div>

    <div class="form-row">
      <textarea id="wordInput" rows="3" placeholder="Enter custom words here, separated by commas or new lines..."></textarea>
    </div>

    <div class="form-row">
      <label>Upload Word File:</label>
      <input type="file" id="fileInput" onchange="handleFileUpload(event)" />
    </div>

    <div id="trainer"></div>
    <div id="scoreDisplay"></div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    let words = [];
    let userEmail = "";

    function showNotification(message, type = "info") {
      const note = document.createElement("div");
      note.className = `notification ${type}`;
      note.innerHTML = message;
      document.body.appendChild(note);
      setTimeout(() => note.classList.add("show"), 10);
      setTimeout(() => {
        note.classList.remove("show");
        setTimeout(() => note.remove(), 300);
      }, 3000);
    }

    function loginUser() {
      const email = document.getElementById("userEmail").value.trim();
      const password = document.getElementById("userPassword").value;
      if (!email || !password) return showNotification("Email and password required", "error");

      auth.signInWithEmailAndPassword(email, password)
        .then(() => {
          userEmail = email;
          document.getElementById("loginStatus").textContent = `âœ… Logged in as ${email}`;
          showNotification("Login successful!", "success");
        })
        .catch(error => showNotification(error.message, "error"));
    }

    function signUpUser() {
      const email = document.getElementById("userEmail").value.trim();
      const password = document.getElementById("userPassword").value;
      if (!email || !password) return showNotification("Email and password required", "error");

      auth.createUserWithEmailAndPassword(email, password)
        .then(() => {
          userEmail = email;
          document.getElementById("loginStatus").textContent = `âœ… Account created: ${email}`;
          showNotification("Account created and signed in!", "success");
        })
        .catch(error => showNotification(error.message, "error"));
    }

    function logoutUser() {
      auth.signOut()
        .then(() => {
          userEmail = "";
          document.getElementById("loginStatus").textContent = "ðŸ”’ Logged out";
          showNotification("You have logged out", "info");
        })
        .catch(err => showNotification(err.message, "error"));
    }

    auth.onAuthStateChanged(user => {
      if (user) {
        userEmail = user.email;
        document.getElementById("loginStatus").textContent = `âœ… Logged in as ${userEmail}`;
      } else {
        userEmail = "";
        document.getElementById("loginStatus").textContent = "ðŸ”’ Not logged in";
      }
    });

    function startPractice() {
      showNotification("Practice mode starting...", "info");
    }

    function startTest() {
      showNotification("Test mode starting...", "info");
    }

    function addCustomWords() {
      const input = document.getElementById("wordInput").value.trim();
      if (!input) return showNotification("Enter some words", "error");
      words = input.split(/[\n,]+/).map(w => w.trim()).filter(Boolean);
      showNotification("Custom words added!", "success");
    }

    function saveWordList() {
      if (!userEmail) return showNotification("Login first", "error");
      db.collection("wordLists").doc(userEmail).set({ words })
        .then(() => showNotification("Words saved to cloud!", "success"))
        .catch(err => showNotification("Failed to save: " + err.message, "error"));
    }

    function loadWordList() {
      if (!userEmail) return showNotification("Login first", "error");
      db.collection("wordLists").doc(userEmail).get()
        .then(doc => {
          if (doc.exists) {
            words = doc.data().words || [];
            showNotification("Words loaded from cloud!", "success");
          } else {
            showNotification("No saved list found.", "info");
          }
        })
        .catch(err => showNotification("Error loading: " + err.message, "error"));
    }

    function clearWordList() {
      words = [];
      showNotification("Word list cleared.", "success");
    }

    function handleFileUpload(event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(e) {
        const text = e.target.result;
        words = text.split(/[\n,]+/).map(w => w.trim()).filter(Boolean);
        showNotification(`${words.length} words loaded from file`, "success");
      };
      reader.readAsText(file);
    }
  </script>
</body>
</html>
